// import { View, Text, FlatList } from 'react-native';
// import React from 'react';
// import ChatListItem from '../../components/Chats/ChatListItem';
// const chats = [
//   {
//     id: '1',
//     username: 'Ahmet',
//     avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
//     lastMessage: 'Nasƒ±lsƒ±n?',
//     lastMessageDate: new Date(),
//     isSentByUser: false,
//   },
//   {
//     id: '2',
//     username: 'Ay≈üe',
//     avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
//     lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
//     lastMessageDate: new Date(Date.now() - 86400000),
//     isSentByUser: true,
//   },
// ];
// export default function IncomingChatsScreen() {
//   return (
//     <View>
//       <Text>IncomingChatsScreen</Text>
//       <FlatList
//         data={chats}
//         keyExtractor={item => item.id}
//         renderItem={({ item }) => (
//           <ChatListItem
//             avatarUrl={item.avatarUrl}
//             username={item.username}
//             lastMessage={item.lastMessage}
//             lastMessageDate={item.lastMessageDate}
//             isSentByUser={item.isSentByUser}
//           />
//         )}
//       />
//     </View>
//   );
// }
// src/screens/Chats/IncomingChatsScreen.tsx
// import React, { useState } from 'react';
// import {
//   View,
//   Text,
//   FlatList,
//   StyleSheet,
//   TouchableOpacity,
//   Modal,
//   Pressable,
//   useColorScheme,
// } from 'react-native';
// import Icon from 'react-native-vector-icons/Ionicons';
// import ChatListItem from '../../components/Chats/ChatListItem';
// import { useThemeProvider } from '../../lib/theme/ThemeProvider';
// import { useTheme } from '@react-navigation/native';

// const chats = [
//   {
//     id: '1',
//     username: 'Ahmet',
//     avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
//     lastMessage: 'Nasƒ±lsƒ±n?',
//     lastMessageDate: new Date(),
//     isSentByUser: false,
//   },
//   {
//     id: '2',
//     username: 'Ay≈üe',
//     avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
//     lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
//     lastMessageDate: new Date(Date.now() - 86400000),
//     isSentByUser: true,
//   },
// ];

// export default function IncomingChatsScreen() {
//   const { mode } = useThemeProvider();
//   const { colors } = useTheme();

//   const [menuVisible, setMenuVisible] = useState(false);

//   const toggleMenu = () => setMenuVisible(!menuVisible);

//   return (
//     <View style={[styles.container, { backgroundColor: colors.background }]}>
//       {/* üß≠ Header */}
//       <View style={[styles.header, { borderBottomColor: colors.border }]}>
//         <Text style={[styles.title, { color: colors.text }]}>
//           Gelen Mesajlar
//         </Text>

//         <TouchableOpacity onPress={toggleMenu}>
//           <Icon name="ellipsis-vertical" size={22} color={colors.text} />
//         </TouchableOpacity>
//       </View>

//       {/* üì® Chat listesi */}
//       <FlatList
//         data={chats}
//         keyExtractor={item => item.id}
//         renderItem={({ item }) => (
// <ChatListItem
//   avatarUrl={item.avatarUrl}
//   username={item.username}
//   lastMessage={item.lastMessage}
//   lastMessageDate={item.lastMessageDate}
//   isSentByUser={item.isSentByUser}
// />
//         )}
//         contentContainerStyle={{ paddingBottom: 50 }}
//       />

//       {/* ‚öôÔ∏è Men√º Modal */}
//       <Modal
//         transparent
//         visible={menuVisible}
//         animationType="fade"
//         onRequestClose={() => setMenuVisible(false)}
//       >
//         <Pressable
//           style={styles.modalOverlay}
//           onPress={() => setMenuVisible(false)}
//         >
//           <View
//             style={[
//               styles.menuContainer,
//               { backgroundColor: colors.card, borderColor: colors.border },
//             ]}
//           >
//             <TouchableOpacity
//               style={styles.menuItem}
//               onPress={() => {
//                 setMenuVisible(false);
//                 console.log('Yeni sohbet');
//               }}
//             >
//               <Icon name="chatbubble-outline" size={18} color={colors.text} />
//               <Text style={[styles.menuText, { color: colors.text }]}>
//                 Yeni sohbet
//               </Text>
//             </TouchableOpacity>

//             <TouchableOpacity
//               style={styles.menuItem}
//               onPress={() => {
//                 setMenuVisible(false);
//                 console.log('Ayarlar');
//               }}
//             >
//               <Icon name="settings-outline" size={18} color={colors.text} />
//               <Text style={[styles.menuText, { color: colors.text }]}>
//                 Ayarlar
//               </Text>
//             </TouchableOpacity>
//           </View>
//         </Pressable>
//       </Modal>
//     </View>
//   );
// }

// const styles = StyleSheet.create({
//   container: {
//     flex: 1,
//   },
//   header: {
//     paddingTop: 15,
//     paddingHorizontal: 20,
//     paddingBottom: 14,
//     flexDirection: 'row',
//     alignItems: 'center',
//     justifyContent: 'space-between',
//     borderBottomWidth: StyleSheet.hairlineWidth,
//   },
//   title: {
//     fontSize: 22,
//     fontWeight: '600',
//   },
//   modalOverlay: {
//     flex: 1,
//     justifyContent: 'flex-start',
//     alignItems: 'flex-end',
//     paddingTop: 50,
//     paddingRight: 16,
//     backgroundColor: 'rgba(0,0,0,0.4)',
//   },
//   menuContainer: {
//     width: 180,
//     borderRadius: 12,
//     borderWidth: 1,
//     overflow: 'hidden',
//     shadowColor: '#ffffffff',
//     shadowOpacity: 0.2,
//     shadowRadius: 2,
//     elevation: 3,
//   },
//   menuItem: {
//     flexDirection: 'row',
//     alignItems: 'center',
//     paddingVertical: 12,
//     paddingHorizontal: 14,
//   },
//   menuText: {
//     fontSize: 15,
//     marginLeft: 10,
//   },
// });

import React, { useState } from 'react';
import {
  View,
  Text,
  FlatList,
  StyleSheet,
  TouchableOpacity,
  Modal,
  Pressable,
  Platform, // Platforma √∂zel stil i√ßin ekledim
} from 'react-native';
import Icon from 'react-native-vector-icons/Ionicons';
import IconFeather from 'react-native-vector-icons/Feather';
import ChatListItem from '../../components/Chats/ChatListItem';
import { useThemeProvider } from '../../lib/theme/ThemeProvider';
import { useTheme } from '@react-navigation/native';
import { useI18n } from '../../languages/I18nProvider';

// Sabit verileriniz (deƒüi≈ümedi)
const chats: ArrayLike<any> | null | undefined = [
  {
    id: '1',
    username: 'Ahmet',
    avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
    lastMessage: 'Nasƒ±lsƒ±n?',
    lastMessageDate: new Date(),
    isSentByUser: true,
  },
  {
    id: '2',
    username: 'Ay≈üe',
    avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
    lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
    lastMessageDate: new Date(Date.now() - 86400000),
    isSentByUser: true,
  },
  // {
  //   id: '3',
  //   username: 'Ahmet',
  //   avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
  //   lastMessage: 'Nasƒ±lsƒ±n?',
  //   lastMessageDate: new Date(),
  //   isSentByUser: false,
  // },
  // {
  //   id: '4',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
  // {
  //   id: '5',
  //   username: 'Ahmet',
  //   avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
  //   lastMessage: 'Nasƒ±lsƒ±n?',
  //   lastMessageDate: new Date(),
  //   isSentByUser: false,
  // },
  // {
  //   id: '6',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
  // {
  //   id: '7',
  //   username: 'Ahmet',
  //   avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
  //   lastMessage: 'Nasƒ±lsƒ±n?',
  //   lastMessageDate: new Date(),
  //   isSentByUser: false,
  // },
  // {
  //   id: '8',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
  // {
  //   id: '9',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
  // {
  //   id: '10',
  //   username: 'Ahmet',
  //   avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
  //   lastMessage: 'Nasƒ±lsƒ±n?',
  //   lastMessageDate: new Date(),
  //   isSentByUser: false,
  // },
  // {
  //   id: '11',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
  // {
  //   id: '12',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
  // {
  //   id: '13',
  //   username: 'Ahmet',
  //   avatarUrl: 'https://randomuser.me/api/portraits/men/1.jpg',
  //   lastMessage: 'Nasƒ±lsƒ±n?',
  //   lastMessageDate: new Date(),
  //   isSentByUser: false,
  // },
  // {
  //   id: '14',
  //   username: 'Ay≈üe',
  //   avatarUrl: 'https://randomuser.me/api/portraits/women/2.jpg',
  //   lastMessage: 'G√∂r√º≈ü√ºr√ºz!',
  //   lastMessageDate: new Date(Date.now() - 86400000),
  //   isSentByUser: true,
  // },
];
interface MenuItemProps {
  iconName: string;
  text: string;
  onPress: () => void; // A function that returns nothing
}
export default function IncomingChatsScreen() {
  const { mode } = useThemeProvider();
  const { colors } = useTheme();
  const { t } = useI18n();
  const [menuVisible, setMenuVisible] = useState(false);

  const toggleMenu = () => setMenuVisible(!menuVisible);

  // Men√º √∂ƒüesi bile≈üeni (Tekrar eden kodu temizler)
  const MenuItem = ({ iconName, text, onPress }: MenuItemProps) => (
    <Pressable
      onPress={onPress}
      style={({ pressed }) => [
        styles.menuItem,
        {
          backgroundColor: pressed
            ? colors.border // Hafif basma efekti
            : colors.card,
          borderBottomColor: colors.border,
        },
      ]}
    >
      <Icon name={iconName} size={18} color={colors.text} />
      <Text style={[styles.menuText, { color: colors.text }]}>{text}</Text>
    </Pressable>
  );
  const EmptyChatList = () => (
    <View style={styles.emptyContainer}>
      <IconFeather
        name="inbox" // Gelen kutusu bo≈üluƒüunu temsil eden ikon
        size={70}
        color={colors.text}
        style={styles.emptyIcon}
      />
      <Text style={[styles.emptyTitle, { color: colors.text }]}>
        {t('no_incoming_chats.title')}
      </Text>
      <Text style={[styles.emptySubtitle, { color: colors.text }]}>
        {t('no_incoming_chats.desc')}
      </Text>
      {/* ƒ∞steƒüe baƒülƒ±: Kullanƒ±cƒ±yƒ± y√∂nlendiren bir buton eklenebilir.
        √ñrn: <TouchableOpacity style={[styles.emptyButton, {backgroundColor: colors.primary}]}>
                <Text style={styles.emptyButtonText}>Yeni Sohbet Ba≈ülat</Text>
             </TouchableOpacity>
      */}
    </View>
  );
  return (
    <View style={[styles.container, { backgroundColor: colors.background }]}>
      {/* üß≠ Header - ƒ∞yile≈ütirilmi≈ü Stil */}
      <View
        style={[
          styles.header,
          {
            backgroundColor: colors.card, // Arka plan rengi eklendi
            borderBottomColor: colors.border,
          },
        ]}
      >
        {/* Sol tarafta bo≈üluk bƒ±rakƒ±ldƒ± veya ba≈üka bir ikon eklenebilir */}
        <View style={styles.leftHeaderFiller} />

        <Text style={[styles.title, { color: colors.text }]}>
          {t('incoming_chats.title')}
        </Text>

        <TouchableOpacity style={styles.menuButton} onPress={toggleMenu}>
          <Icon name="ellipsis-vertical" size={24} color={colors.text} />
        </TouchableOpacity>
      </View>

      {/* üì® Chat listesi */}
      <FlatList
        data={chats}
        keyExtractor={item => item.id}
        renderItem={({ item }) => (
          <ChatListItem
            username={item.username}
            lastMessage={item.lastMessage}
            lastMessageDate={item.lastMessageDate}
            isSentByUser={item.isSentByUser}
          />
        )}
        contentContainerStyle={{ paddingBottom: 50, flexGrow: 1 }} // flexGrow: 1, EmptyState'in ortalanmasƒ± i√ßin √∂nemli
        // 2. ANA DEƒûƒ∞≈ûƒ∞KLƒ∞K: ListEmptyComponent eklendi
        ListEmptyComponent={EmptyChatList}
      />

      {/* ‚öôÔ∏è Men√º Modal - ƒ∞yile≈ütirilmi≈ü Stil */}
      <Modal
        transparent
        visible={menuVisible}
        animationType="fade"
        onRequestClose={() => setMenuVisible(false)}
      >
        <Pressable
          style={styles.modalOverlay}
          onPress={() => setMenuVisible(false)}
        >
          <View
            style={[
              styles.menuContainer,
              { backgroundColor: colors.card, borderColor: colors.border },
            ]}
          >
            <MenuItem
              iconName="chatbubble-outline"
              text="Yeni Sohbet"
              onPress={() => {
                setMenuVisible(false);
                console.log('Yeni sohbet');
              }}
            />
            {/* Ayƒ±rƒ±cƒ± √ßizgi otomatik olarak MenuItem i√ßinde style ile geliyor */}
            <MenuItem
              iconName="settings-outline"
              text="Ayarlar"
              onPress={() => {
                setMenuVisible(false);
                console.log('Ayarlar');
              }}
            />
          </View>
        </Pressable>
      </Modal>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
  },
  emptyContainer: {
    flex: 1, // Listeyi doldurmasƒ± i√ßin
    justifyContent: 'center',
    alignItems: 'center',
    padding: 30,
    marginTop: 50, // Header'ƒ±n altƒ±ndan ba≈ülamasƒ± i√ßin biraz bo≈üluk
  },
  emptyIcon: {
    marginBottom: 20,
    opacity: 0.6,
  },
  emptyTitle: {
    fontSize: 20,
    fontWeight: '700',
    marginBottom: 8,
    textAlign: 'center',
  },
  emptySubtitle: {
    fontSize: 15,
    fontWeight: '400',
    textAlign: 'center',
    opacity: 0.7,
  },
  // Header ƒ∞yile≈ütirmeleri
  header: {
    height: Platform.OS === 'ios' ? 95 : 60, // iOS'ta daha y√ºksek, b√ºy√ºk ba≈ülƒ±k stili
    paddingTop: Platform.OS === 'ios' ? 40 : 0,
    paddingHorizontal: 16, // T√ºm ekran i√ßin tutarlƒ± padding
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    // borderBottomWidth kaldƒ±rƒ±ldƒ±, yerine g√∂lge eklenebilir (Android'de elevation, iOS'ta shadow)
    ...Platform.select({
      ios: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 1 },
        shadowOpacity: 0.08,
        shadowRadius: 1,
      },
      android: {
        elevation: 4,
      },
    }),
  },
  title: {
    fontSize: 21, // Ba≈ülƒ±k daha belirgin yapƒ±ldƒ±
    fontWeight: '700', // Daha kalƒ±n yapƒ±ldƒ±
    flex: 1, // Ortalanmaya yardƒ±mcƒ± olmak i√ßin
    textAlign: 'center', // Ba≈ülƒ±k ortalandƒ±
  },
  menuButton: {
    padding: 5, // Dokunma alanƒ±nƒ± geni≈ületmek i√ßin
  },
  leftHeaderFiller: {
    width: 34, // ƒ∞konun kapladƒ±ƒüƒ± alan kadar bo≈üluk (yakla≈üƒ±k 24px icon + 5px padding * 2)
  },

  // Liste ƒ∞yile≈ütirmeleri
  listContentContainer: {
    paddingBottom: 50,
  },

  // Modal ƒ∞yile≈ütirmeleri
  modalOverlay: {
    flex: 1,
    justifyContent: 'flex-start',
    alignItems: 'flex-end',
    paddingTop: Platform.OS === 'ios' ? 95 : 50, // Header y√ºksekliƒüine g√∂re ayarlandƒ±
    paddingRight: 20, // Men√ºy√º saƒüa daha yakƒ±n konumlandƒ±rdƒ±k
    backgroundColor: 'rgba(0,0,0,0.3)', // Daha ≈üƒ±k bir g√∂lgelendirme
  },
  menuContainer: {
    width: 200, // Daha geni≈ü men√º
    borderRadius: 10, // Daha yumu≈üak k√∂≈üeler
    // borderWidth kaldƒ±rƒ±ldƒ±, g√∂lge daha √ßok √∂n planda
    ...Platform.select({
      ios: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.15,
        shadowRadius: 6,
      },
      android: {
        elevation: 8,
      },
    }),
    overflow: 'hidden',
  },
  menuItem: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingVertical: 15, // Daha fazla dikey bo≈üluk
    paddingHorizontal: 16,
    borderBottomWidth: StyleSheet.hairlineWidth, // Ayƒ±rƒ±cƒ± √ßizgi eklendi
  },
  menuText: {
    fontSize: 16, // Daha okunaklƒ± font boyutu
    marginLeft: 12,
    fontWeight: '500',
  },
});
